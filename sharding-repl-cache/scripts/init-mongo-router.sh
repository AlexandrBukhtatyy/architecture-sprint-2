#!/bin/bash
############################################################
# Help                                                     #
############################################################
Help()
{
   # Display Help
   echo "Настройка mongo-роутера"
}
############################################################
############################################################
# Arguments checking                                       #
############################################################
############################################################
if [ "$1" = "" ]
then
  echo "Service name is requered!"
  exit
fi

if [ "$2" = "" ]
then
  echo "Port is requered!"
  exit
fi
############################################################
############################################################
# Main program                                             #
############################################################
############################################################

docker compose exec -T $1 mongosh --port $2 <<EOF
sh.addShard("shard1/shard1_r0:27018,shard1_r1:27018,shard1_r2:27018");
sh.addShard("shard2/shard2_r0:27019,shard2_r1:27019,shard2_r2:27019");
sh.enableSharding("somedb");
sh.shardCollection("somedb.helloDoc", { "name" : "hashed" } )
exit();
EOF